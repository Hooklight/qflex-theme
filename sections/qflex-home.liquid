{%- comment -%}
  QFlex home section displays hero eyebrow, rating, review count and USP pills.
  Values are pulled from product metafields in namespace `qf` with sensible
  defaults from section settings when metafields are absent. This ensures
  merchants can manage content via Dynamic Sources while maintaining
  backwardsâ€‘compatible fallbacks.
{%- endcomment -%}

{%- liquid
  assign hero_eyebrow = product.metafields.qf.hero_eyebrow.value | default: section.settings.eyebrow_text
  assign avg_rating_raw = product.metafields.qf.avg_rating.value | default: 4.8
  assign avg_rating = avg_rating_raw | plus: 0 | round: 1
  assign review_count = product.metafields.qf.review_count.value | default: 2000
  if product.metafields.qf.usp_pills.value != blank
    assign usp_items = product.metafields.qf.usp_pills.value
  else
    assign usp_items = section.settings.usp_pills
  endif
-%}

<div class="qflex-hero">
  {%- if hero_eyebrow != blank -%}
    <p class="eyebrow">{{ hero_eyebrow }}</p>
  {%- endif -%}
  <p class="rating">
    {{ avg_rating }}/5
    <span class="review-count">({{ review_count }})</span>
  </p>
  {%- if usp_items != blank -%}
    <ul class="usp-pills">
      {%- for usp in usp_items -%}
        <li>{{ usp }}</li>
      {%- endfor -%}
    </ul>
  {%- endif -%}
</div>